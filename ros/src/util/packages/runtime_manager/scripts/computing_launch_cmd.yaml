name : Computing
subs :
  - name : Control
    subs :
      - name : motion
        subs :
          - name : pure_pursuit(sim)
            cmd : roslaunch lane_follower pure_pursuit_sim.launch
            param: lane_follower
            gui  :
              velocity:
                depend : param_flag
              lookahead_threshold:
                depend : param_flag
          - name : pure_pursuit
            cmd : roslaunch lane_follower pure_pursuit.launch
            param: lane_follower
            gui  :
              velocity:
                depend : param_flag
              lookahead_threshold:
                depend : param_flag
          - name : odom_gen
            cmd : roslaunch lane_follower odom_gen.launch  
            param: odom_gen
            gui  :
              use_pose:
                flags : [ no_category, nl ]
              x:
                depend      : use_pose
                depend_bool : 'lambda v : v == "Initial Pos"'
                flags : [ no_category ]
              y:
                depend      : use_pose
                depend_bool : 'lambda v : v == "Initial Pos"'
                flags : [ no_category ]
              z:
                depend      : use_pose
                depend_bool : 'lambda v : v == "Initial Pos"'
                flags : [ no_category, nl ]
              roll:
                depend      : use_pose
                depend_bool : 'lambda v : v == "Initial Pos"'
                flags : [ no_category ]
              pitch:
                depend      : use_pose
                depend_bool : 'lambda v : v == "Initial Pos"'
                flags : [ no_category ]
              yaw:
                depend      : use_pose
                depend_bool : 'lambda v : v == "Initial Pos"'
                flags : [ no_category, nl ]
  
  - name : Perception
    subs :
      - name : Detection
        subs :
          - name : car_dpm
            cmd  : rosrun car_detector car_dpm
            param: car_dpm
          - name : car_dpm_gpu
            cmd  : rosrun car_detector car_dpm_gpu
            param: car_dpm
          - name : car_fusion
            cmd  : rosrun car_detector car_fusion
          - name : car_kf
            cmd  : rosrun car_detector car_kf
            param: car_kf
          - name : hog
            cmd  : 
          - name : hog_gpu
            cmd  : 
          #- name : lane_detector
          #  cmd  : rosrun lane_detector lane_detector
          - name : lane_cannyhough
            cmd  : 
          - name : lane_fusion
            cmd  : 
          - name : lane_tracking
            cmd  : 
          - name : pedestrian_dpm
            cmd  : rosrun pedestrian_detector pedestrian_dpm
            param: pedestrian_dpm
          - name : pedestrian_dpm_gpu
            cmd  : rosrun pedestrian_detector pedestrian_dpm_gpu
            param: pedestrian_dpm
          - name : pedestrian_fusion
            cmd  : rosrun pedestrian_detector pedestrian_fusion
          - name : pedestrian_kf
            cmd  : rosrun pedestrian_detector pedestrian_kf
            param: pedestrian_kf
      - name : Localization
        subs :
          - name : ndt_pcl
            cmd  : roslaunch points_localizer ndt_pcl.launch
           # cmd  : rosrun points_localizer ndt_pcl
          #- name : ndt
          #  cmd  : echo ndt
            param: ndt
          - name : fix2tfpose
            cmd  : rosrun gnss_localizer fix2tfpose
          - name : nmea2tfpose
            cmd  : rosrun gnss_localizer nmea2tfpose
          - name : pos_master
            cmd  : echo pos_master
          - name : ndt_slam
            cmd  : roslaunch points_localizer ndt_slam.launch
            param: ndt_slam
            gui  :
              dialog : MyDialogNdtSlam

  - name : Planning
    subs :
      - name : Path
        subs :
        - name : lane_navi
          cmd  : rosrun lane_planner lane_navi
          param: lane_navi
        - name : lane_rule
          cmd  : rosrun lane_planner lane_rule
          param: lane_rule
        - name : lane_stop
          cmd  : rosrun lane_planner lane_stop
          param: lane_stop
          gui  :
            dialog: MyDialogLaneStop
        - name : waypoint_saver
          cmd  : roslaunch waypoint_maker waypoint_saver.launch
          param: waypoint_saver
          gui  :
            save_filename :
              prop  : 1
        - name : waypoint_loader
          cmd  : roslaunch waypoint_maker waypoint_loader.launch
          param: waypoint_loader
          gui  :
            waypoint_filename :
              prop  : 1

params :
  - name  : car_dpm
    topic : /config/car_dpm
    msg   : ConfigCarDpm
    vars  :
    - name  : score_threshold
      label : Score Threshold
      min   : -2
      max   : 2
      v     : -0.5
    - name  : group_threshold
      label : Group Threshold
      min   : 0
      max   : 1
      v     : 0.1
    - name  : Lambda
      label : Lambda
      min   : 1
      max   : 20
      v     : 10
    - name  : num_cells
      label : Num Cells
      min   : 2
      max   : 10
      v     : 8
    - name  : num_bins
      label : Num Bins
      min   : 2
      max   : 10
      v     : 9

  - name  : pedestrian_dpm
    topic : /config/pedestrian_dpm
    msg   : ConfigPedestrianDpm
    vars  :
    - name  : score_threshold
      label : Score Threshold
      min   : -2
      max   : 2
      v     : 0.6
    - name  : group_threshold
      label : Group Threshold
      min   : 0
      max   : 1
      v     : 0.3
    - name  : Lambda
      label : Lambda
      min   : 1
      max   : 20
      v     : 10
    - name  : num_cells
      label : Num Cells
      min   : 2
      max   : 10
      v     : 8
    - name  : num_bins
      label : Num Bins
      min   : 2
      max   : 10
      v     : 9

  - name  : ndt
    topic : /config/ndt
    msg   : ConfigNdt
    vars  :
    - name  : init_pos_gnss
      kind  : radio_box
      choices:
      - Initial Pos
      - GNSS
      v     : 1
    - name  : x
      label : 'x:'
      v     : 0.0
    - name  : y
      label : 'y:'
      v     : 0.0
    - name  : z
      label : 'z:'
      v     : 0.0
    - name  : roll
      label : 'roll:'
      v     : 0.0
    - name  : pitch
      label : 'pitch:'
      v     : 0.0
    - name  : yaw
      label : 'yaw:'
      v     : 0.0
    - name  : resolution
      label : Resolution
      min   : 0
      max   : 10
      v     : 1.0
    - name  : step_size
      label : Step Size
      min   : 0
      max   : 1
      v     : 0.1
    - name  : trans_esp
      label : Trans ESP
      min   : 0
      max   : 0.1
      v     : 0.01
    - name  : leaf_size
      label : Leaf Size
      min   : 0
      max   : 10
      v     : 0.1
    - name  : angle_error
      label : Angle Error
      min   : -180.0
      max   : 180.0
      step  : 0.1
      v     : 0
    - name  : shift_x
      label : Shift X
      min   : -2.0
      max   : 2.0
      v     : 0
    - name  : shift_y
      label : Shift Y
      min   : -2.0
      max   : 2.0
      v     : 0
    - name  : shift_z
      label : Shift Z
      min   : -2.0
      max   : 2.0
      v     : 0

  - name  : lane_follower
    topic : /config/lane_follower
    msg   : ConfigLaneFollower
    vars  :
    - name  : param_flag
      kind  : radio_box
      choices:
      - Waypoint
      - Dialog
      v     : 1
    - name  : velocity
      label : Velocity
      min   : 0
      max   : 60
      v     : 5.0
    - name  : lookahead_threshold
      label : Lookahead Threshold
      min   : 0
      max   : 30
      v     : 4.0

  - name  : odom_gen
    vars  :
    - name    : use_pose
      kind    : radio_box
      choices :
      - Initial Pos
      - NDT
      - GNSS
      choices_type: str
      v       : Initial Pos
      rosparam: /odom_gen/use_pose
    - name    : x
      label   : 'X:'
      v       : 0.0
      rosparam: /odom_gen/initial_pos_x
    - name    : y
      label   : 'Y:'
      v       : 0.0
      rosparam: /odom_gen/initial_pos_y
    - name    : z
      label   : 'Z:'
      v       : 0.0
      rosparam: /odom_gen/initial_pos_z
    - name    : roll
      label   : 'Roll:'
      v       : 0.0
      rosparam: /odom_gen/initial_pos_roll
    - name    : pitch
      label   : 'Pitch:'
      v       : 0.0
      rosparam: /odom_gen/initial_pos_pitch
    - name    : yaw
      label   : 'Yaw:'
      v       : 0.0
      rosparam: /odom_gen/initial_pos_yaw

  - name  : car_kf
    topic : /config/car_kf
    msg   : ConfigCarKf
    vars  :
    - name  : initial_lifespan
      label : Initial Lifespan
      min   : 1
      max   : 100
      v     : 2
    - name  : default_lifespan
      label : Default Lifespan
      min   : 1
      max   : 100
      v     : 10
    - name  : noise_covariance
      label : Noise Covariance
      min   : 1
      max   : 1000
      v     : 1.0
    - name  : measurement_noise_covariance
      label : Measurement Noise Covariance
      min   : 1
      max   : 1000
      v     : 25.0
    - name  : error_estimate_covariance
      label : Error estimate covariance
      min   : 1
      max   : 10000000
      v     : 1000000.0
    - name  : percentage_of_overlapping
      label : Percentage of Overlapping
      min   : 0
      max   : 100
      v     : 0.0

  - name  : pedestrian_kf
    topic : /config/pedestrian_kf
    msg   : ConfigPedestrianKf
    vars  :
    - name  : initial_lifespan
      label : Initial Lifespan
      min   : 1
      max   : 100
      v     : 2
    - name  : default_lifespan
      label : Default Lifespan
      min   : 1
      max   : 100
      v     : 10
    - name  : noise_covariance
      label : Noise Covariance
      min   : 1
      max   : 1000
      v     : 1.0
    - name  : measurement_noise_covariance
      label : Measurement Noise Covariance
      min   : 1
      max   : 1000
      v     : 25.0
    - name  : error_estimate_covariance
      label : Error estimate covariance
      min   : 1
      max   : 10000000
      v     : 1000000.0
    - name  : percentage_of_overlapping
      label : Percentage of Overlapping
      min   : 0
      max   : 100
      v     : 0.0

  - name : lane_navi
    vars :
    - name      : vector_map
      kind      : path
      path_type : dir
      v         : /tmp
      rosparam  : /lane_navi/vector_map_directory

  - name  : lane_rule
    topic : /config/lane_rule
    msg   : ConfigLaneRule
    vars  :
    - name      : vector_map
      kind      : path
      path_type : dir
      v         : /tmp
      rosparam  : /lane_rule/vector_map_directory
    - name      : ruled_waypoint
      kind      : path
      path_type : save
      v         : /tmp/ruled_waypoint.csv
      rosparam  : /lane_rule/ruled_waypoint_csv
    - name      : velocity
      label     : Velocity (km/h)
      min       : 0
      max       : 200
      v         : 40.0
    - name      : difference_around_signal
      label     : Difference around Signal (km/h)
      min       : 0
      max       : 20
      v         : 2.0

  - name  : lane_stop
    topic : /traffic_light
    msg   : traffic_light
    vars  :
    - name  : traffic_light
      v     : 0

  - name  : waypoint_saver
    vars  :
    - name      : save_filename
      kind      : path
      path_type : save
      v         : ''
      cmd_param :
        only_enable : True
        var_name    : save_finename
        dash        : ''
        delim       : ':='
    - name      : interval
      label     : Interval
      v         : 4.0
      cmd_param :
        only_enable : True
        dash        : ''
        delim       : ':='

  - name  : waypoint_loader
    topic : /config/waypoint_loader
    msg   : ConfigWaypointLoader
    vars  :
    - name      : vector_map
      kind      : path
      path_type : dir
      v         : /tmp
      rosparam  : /waypoint_loader/vector_map_directory
    - name      : ruled_waypoint
      kind      : path
      v         : /tmp/ruled_waypoint.csv
      rosparam  : /waypoint_loader/ruled_waypoint_csv
    - name      : velocity
      label     : Velocity (km/h)
      min       : 0
      max       : 200
      v         : 40.0
    - name      : difference_around_signal
      label     : Difference around Signal (km/h)
      min       : 0
      max       : 20
      v         : 2.0

  - name  : ndt_slam
    vars  :
    - name      : map_resolution
      v         : 0.2
      cmd       : rostopic pub --once /output std_msgs/Float32
